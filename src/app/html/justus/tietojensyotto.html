<div class="alert alert-transparent text-center" data-ng-if="justus.id">
  <h4>Muokkaat julkaisua {{ justus.id }}, {{ justus.julkaisunnimi }}</h4>
  <button class="btn btn-primary" data-ng-click="clearFormAndReturnToStart()">
    Hylkää muutokset ja siirry alkuun
  </button>
</div>

<!-- alun yhteiset -->
<span data-ng-if="!loading.publication">
  <h3 class="form-header">{{i18n.content.tietojensyotto.yleiset[lang]}}</h3>

  <!-- Kenttä: Julkaisuvuosi -->
  <div class="row form-group" id="julkaisuvuosiGroup" data-ng-if="isFieldVisible('julkaisuvuosi')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.julkaisuvuosi[lang]"></label>
      <i class="fa fa-info-circle justus-info justus-color"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisuvuosi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisuvuosi.tooltip[lang]">
      </i>
      <span class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_julkaisuvuosi">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.julkaisuvuosi"
            maxlength="4"
            pattern="^[0-9]{4}$"
            placeholder="{{ i18n.content.form.julkaisuvuosi.picktip[lang] }}"
            title="{{i18n.content.form.julkaisuvuosi.tooltip[lang]}}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('julkaisuvuosi')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisuvuodenlisätieto -->
  <div class="row form-group" data-ng-if="isFieldVisible('julkaisuvuodenlisatieto')" id="julkaisuvuodenlisatieto">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.julkaisuvuodenlisatieto[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'" data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.julkaisuvuodenlisatieto.tooltip[lang]}}"
         data-ng-show="i18n.content.form.julkaisuvuodenlisatieto.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisuvuodenlisatieto')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
         data-ng-model="req_julkaisuvuodenlisatieto" data-ng-required="requiredHighlight && !isValid('julkaisuvuodenlisatieto')">
      <div class="row">
        <div class="col-xs-10">
          <textarea type="text" class="form-control vertical-resize"
                    rows="1"
                    maxlength="1000"
                    placeholder="{{i18n.content.form.julkaisuvuodenlisatieto.picktip[lang]}}"
                    data-ng-model="justus.tempLisatieto.julkaisuvuosi.lisatietoteksti">
          </textarea>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
             data-ng-if="requiredHighlight && !isValid('julkaisuvuodenlisatieto')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisun nimi -->
  <div class="row form-group"
    id="julkaisunnimiGroup"
    data-ng-if="isFieldVisible('julkaisunnimi')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.julkaisunnimi[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisunnimi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisunnimi.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisunnimi')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_julkaisunnimi">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.julkaisunnimi"
            placeholder="{{ i18n.content.form.julkaisunnimi.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('julkaisunnimi')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Tekijät -->
  <div class="row form-group" id="tekijatGroup" data-ng-if="isFieldVisible('tekijat')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.tekijat[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.tekijat.tooltip[lang]}}"
        data-ng-show="i18n.content.form.tekijat.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('tekijat')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_tekijat">
      <div class="row">
        <div class="col-xs-10">
          <tags-input data-ng-model="tekijatTags"
            data-replace-spaces-with-dashes="false"
            data-add-on-comma="false"
            data-add-on-space="false"
            placeholder="{{i18n.content.form.tekijat.picktip[lang]}}"
            data-on-tag-added="useTekijat()"
            data-on-tag-removed="useTekijat()"
            enable-editing-last-tag="true"
            allowed-tags-pattern="^[^,\;]+,[^,\;]+$">
          </tags-input>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('tekijat')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisun tekijöiden lukumäärä -->
  <div class="row form-group"
    id="julkaisuntekijoidenlukumaaraGroup"
    data-ng-if="isFieldVisible('julkaisuntekijoidenlukumaara')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.julkaisuntekijoidenlukumaara[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
      data-popover-trigger="'mouseenter'" data-popover-placement="right"
      data-uib-popover="{{i18n.content.form.julkaisuntekijoidenlukumaara.tooltip[lang]}}"
      data-ng-show="i18n.content.form.julkaisuntekijoidenlukumaara.tooltip[lang]"></i>
      <span data-ng-if="isFieldRequired('julkaisuntekijoidenlukumaara')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_julkaisuntekijoidenlukumaara">
      <div class="row">
        <div class="col-xs-5">
          <input type="text" class="form-control"
          data-ng-model="justus.julkaisuntekijoidenlukumaara"
          maxlength="2" pattern="^[0-9]*$">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-5 justus-data text-right">
          <span class="btn btn-primary justus-btn"
            data-ng-click="useKopioiTekijat(justus.tekijat)"
            data-ng-show="justus.tekijat && !(justus.organisaatiotekija[0].sukunimi || justus.organisaatiotekija[0].etunimet)"
            data-popover-trigger="'mouseenter'"
            tdata-popover-placement="right"
            data-uib-popover="{{i18n.content.form.organisaatiotekija.kopioi.tooltip[lang]}}"
            data-ng-bind="i18n.content.form.organisaatiotekija.kopioi[lang]">
          </span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('julkaisuntekijoidenlukumaara')">
          </i>
        </div>
      </div>
    </div>
  </div>


  <!-- Kenttä alayksikön vuosivalinta, hide from members, set default as 2017-->
  <div data-ng-if="isFieldVisible('alayksikko')"
      data-ng-show="user.role !== 'member'" class="row form-group">
       <div class="col-xs-12 col-sm-4">
        <label data-ng-bind="i18n.content.form.organisaatiotekija.alayksikkovuosi[lang]">
        </label>
          <i class="fa fa-info-circle justus-info"
             data-popover-trigger="'mouseenter'" data-popover-placement="right"
             data-uib-popover="{{i18n.content.form.organisaatiotekija.alayksikkovuosi.tooltip[lang]}}">
         </i>
      </div>
      <div class="col-xs-12 col-sm-5">
        <ui-select data-ng-model="alayksikkovuosi.selected"
                     theme="bootstrap">
            <ui-select-match class="ui-select-match"
                             data-ng-value="alayksikkovuosi.selected"
                             placeholder="{{i18n.content.form.organisaatiotekija.alayksikkovuosi.picktip[lang]}}">
              {{ $select.selected.label }}
            </ui-select-match>
            <ui-select-choices repeat="ala in alayksikkovuodet">
              {{ala.label}}
            </ui-select-choices>
      </ui-select>
    </div>
  </div>


  <!-- Kenttä: Organisaation tekijät -->
  <div class="row form-group"
    id="organisaatiotekijaGroup"
    data-ng-if="isFieldVisible('organisaatiotekija')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.organisaatiotekija[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.organisaatiotekija.tooltip[lang]}}"
        data-ng-show="i18n.content.form.organisaatiotekija.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('organisaatiotekija')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div data-ng-repeat="i in justus.organisaatiotekija track by $index"
        class="row"
        data-ng-model="req_organisaatiotekija[$index]">
        <div class="col-xs-10">
          <div class="row form-group" id="organisaatiotekijaGroup">
            <div class="col-xs-12 col-sm-6">
              <input type="text" class="form-control"
                data-ng-model="justus.organisaatiotekija[$index].sukunimi"
                placeholder="{{i18n.content.form.organisaatiotekija.sukunimi.picktip[lang]}}">
              <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
            </div>
            <div class="col-xs-12 col-sm-6">
              <input type="text" class="form-control"
                data-ng-model="justus.organisaatiotekija[$index].etunimet"
                placeholder="{{i18n.content.form.organisaatiotekija.etunimet.picktip[lang]}}">
              <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
            </div>
          </div>
          <!-- Kenttä: Tekijän rooli taidejulkaisuille -->
          <div class="row form-group">
            <div data-ng-if="isFieldVisible('tekijanrooli')" id="rooliGroup" class="col-xs-12 col-sm-6 form-group">
            <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
               <ui-select data-ng-model="rooli.selected"
                          on-select="useOrganisaatiotekijaRooli($index,$select.selected)"
                          theme="bootstrap"
                         >
                  <ui-select-match class="ui-select-match"
                                   data-ng-value="justus.organisaatiotekija[$index].rooli"
                                   placeholder="{{justus.organisaatiotekija[$index].rooli}} {{getCode('julkaisuntekijanrooli',justus.organisaatiotekija[$index].rooli).selite[lang] || i18n.content.form.organisaatiotekija.tekijanrooli.picktip[lang]}}">
                    {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
                  </ui-select-match>
                  <ui-select-choices repeat="role in codes.julkaisuntekijanrooli | orderBy: 'arvo' | filter: $select.search">
                    {{role.arvo}} {{role.selite[lang]}}
                  </ui-select-choices>
                </ui-select>
            </div>

            <div data-ng-if="isFieldVisible('alayksikko') && isFieldRequired('alayksikko')" class="col-xs-12 col-sm-6 form-group" id="orcidGroup">
              <input type="text" class="form-control"
                data-ng-model="justus.organisaatiotekija[$index].orcid"
                data-ng-pattern="pattern.orcid" data-orcid-directive=""
                placeholder="{{i18n.content.form.organisaatiotekija.orcid.picktip[lang]}}">
              <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
            </div>

          <div data-ng-if="isFieldVisible('alayksikko') && isFieldRequired('alayksikko')" class="col-xs-12 form-group" id="alayksikkoGroup">
            <div data-ng-repeat="ota in justus.organisaatiotekija[$index].alayksikko track by $index"
            data-ng-init="pIx=$parent.$index" class="row form-group">
              <div class="col-xs-9 col-sm-9">
                <!--<input type="hidden"-->
                  <!--data-ng-model="justus.organisaatiotekija[$parent.$index].alayksikko[$index].alayksikko">-->
                <!--<input type="text"-->
                       <!--ng-disabled="true"-->
                  <!--class="form-control"-->
                  <!--data-ng-model="lab_organisaatiotekija[pIx].alayksikko$index"-->
                  <!--data-ng-value="ota.alayksikko+' '+getCode('organization',ota.alayksikko).selite[lang]"-->
                  <!--data-ng-show="ota.alayksikko">-->
                <!--<span class="fa fa-times form-control-feedback" aria-hidden="true"></span>-->

                <!--
                {{pIx}}-{{$index}}({{justus.organisaatiotekija[$parent.$index].alayksikko.length}})-
                -{{justus.organisaatiotekija[$parent.$index].alayksikko|json}}-
                -"{{justus.organisaatiotekija[$parent.$index].alayksikko[$index]}}"="{{ota}}"
                -->
                <ui-select data-ng-model="alayksikko.selected"
                  on-select="useOrganisaatiotekijaAlayksikko(pIx,$index,$select.selected.arvo)"
                  theme="bootstrap">
                  <ui-select-match class="ui-select-match"
                    placeholder="{{ota.alayksikko}} {{getCode('organization',ota.alayksikko).selite[lang] || i18n.content.form.organisaatiotekija.alayksikko.picktip[lang]}}">
                    {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
                  </ui-select-match>
                  <ui-select-choices repeat="o in getAlayksikkoData(alayksikkovuosi.selected) | filter: $select.search">
                    {{o.arvo}} {{o.selite[lang]}}
                  </ui-select-choices>
                </ui-select>
              </div>
              <div class="col-xs-3 col-sm-3">
                <!--
                {{pIx}}-{{$index}}({{justus.organisaatiotekija[$parent.$index].alayksikko.length}})-
                -{{justus.organisaatiotekija[$parent.$index].alayksikko}}-
                -"{{justus.organisaatiotekija[$parent.$index].alayksikko[$index]}}"="{{a}}"
                -->
                <span class="btn btn-primary"
                  data-ng-click="justus.organisaatiotekija[$parent.$index].alayksikko.splice($index, 1)"
                  data-ng-hide="justus.organisaatiotekija[$parent.$index].alayksikko.length<2"
                  title="{{i18n.content.form.organisaatiotekija.poista.tooltip[lang]}}"
                  data-ng-bind="i18n.content.form.organisaatiotekija.poista[lang]">
                </span>
                <span class="btn btn-primary"
                  data-ng-click="justus.organisaatiotekija[$parent.$index].alayksikko.push({alayksikko:''})"
                  data-ng-show="($index == justus.organisaatiotekija[$parent.$index].alayksikko.length-1 && a!='')"
                  title="{{i18n.content.form.organisaatiotekija.lisaa.tooltip[lang]}}"
                  data-ng-bind="i18n.content.form.organisaatiotekija.lisaa[lang]">
                </span>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="col-xs-2">
          <span class="btn btn-primary"
            data-ng-click="justus.organisaatiotekija.splice($index, 1)"
            data-ng-hide="justus.organisaatiotekija.length<2"
            title="{{i18n.content.form.organisaatiotekija.poista.tooltip[lang]}}"
            data-ng-bind="i18n.content.form.organisaatiotekija.poista.tooltip[lang]">
          </span>
          <span class="btn btn-primary"
            data-ng-click="newot={}; newot.alayksikko = [{alayksikko:''}]; justus.organisaatiotekija.push(newot);"
            data-ng-hide="$index < justus.organisaatiotekija.length-1"
            title="{{i18n.content.form.organisaatiotekija.lisaa.tooltip[lang]}}"
            data-ng-bind="i18n.content.form.organisaatiotekija.lisaa.tooltip[lang]">
          </span>

          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
          data-ng-if="requiredHighlight && !(justus.organisaatiotekija[$index].sukunimi && justus.organisaatiotekija[$index].etunimet
            && justus.organisaatiotekija[$index].alayksikko[0].alayksikko
            )"><!-- nb! ei pakollinen vielä && justus.organisaatiotekija[$index].orcid)" -->
          </i>
        </div>
      </div>
    </div>
  </div>

  <h3 class="form-header">{{i18n.content.tietojensyotto.bibliografiset[lang]}}</h3>

  <!-- julkaisutyypistä riippuvat -->
  <!-- Kenttä: Konferenssin vakiintunut nimi -->
  <div class="row form-group"
    data-ng-if="isFieldVisible('konferenssinvakiintunutnimi')"
    id="konferenssinvakiintunutnimiGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.konferenssinvakiintunutnimi[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.konferenssinvakiintunutnimi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.konferenssinvakiintunutnimi.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('konferenssinvakiintunutnimi')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_konferenssinvakiintunutnimi">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.konferenssinvakiintunutnimi"
            data-uib-typeahead="konferenssinimet.Name for konferenssinimet in refreshKanavanimet(3,$viewValue)"
            data-typeahead-loading="jufoKonferenssiLataa" data-typeahead-no-results="jufoNoResults"
            data-typeahead-wait-ms="300"
            placeholder="{{i18n.content.form.konferenssinvakiintunutnimi.picktip[lang]}}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class='fa fa-spinner fa-spin fa-lg' data-ng-show='jufoKonferenssiLataa'></i>
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
          data-ng-if="requiredHighlight && !isValid('konferenssinvakiintunutnimi')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Emojulkaisun nimi -->
  <div class="row form-group"
    data-ng-if="isFieldVisible('emojulkaisunnimi')"
    id="emojulkaisunnimiGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.emojulkaisunnimi[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.emojulkaisunnimi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.emojulkaisunnimi.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('emojulkaisunnimi')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input
            type="text"
            class="form-control"
            data-ng-model="justus.emojulkaisunnimi"
            placeholder="{{ i18n.content.form.emojulkaisunnimi.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: ISBN :: nb! isbn vs issn. -->
  <div class="row form-group" data-ng-if="isFieldVisible('isbn')" id="isbnGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.isbn[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.isbn.tooltip[lang]}}"
        data-ng-show="i18n.content.form.isbn.tooltip[lang]"></i>
      <span data-ng-if="isFieldRequired('isbn')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.isbn"
            placeholder="{{ i18n.content.form.isbn.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('isbn')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Emojulkaisun toimittajat -->
  <div class="row form-group"
    data-ng-if="isFieldVisible('emojulkaisuntoimittajat')"
    id="emojulkaisuntoimittajatGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.emojulkaisuntoimittajat[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.emojulkaisuntoimittajat.tooltip[lang]}}"
        data-ng-show="i18n.content.form.emojulkaisuntoimittajat.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('emojulkaisuntoimittajat')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-model="justus.emojulkaisuntoimittajat">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Lehden / julkaisusarjan nimi :: näkyy aina -->
  <div class="row form-group"
    id="lehdenjulkaisusarjannimiGroup"
    data-ng-if="isFieldVisible('lehdenjulkaisusarjannimi')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.lehdenjulkaisusarjannimi[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.lehdenjulkaisusarjannimi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.lehdenjulkaisusarjannimi.tooltip[lang]"></i>
      <span data-ng-if="isFieldRequired('lehdenjulkaisusarjannimi')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.lehdenjulkaisusarjannimi"
            data-uib-typeahead="nimet.Name for nimet in refreshKanavanimet(1,$viewValue)"
            data-typeahead-loading="jufoLataa"
            data-typeahead-no-results="jufoNoResults"
            data-typeahead-wait-ms="300"
            placeholder="{{i18n.content.form.lehdenjulkaisusarjannimi.picktip[lang]}}"
            data-typeahead-on-select="useLehtisarja($item.Jufo_ID)">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class='fa fa-spinner fa-spin fa-lg' data-ng-show='jufoLataa'></i>
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('lehdenjulkaisusarjannimi')">
          </i>
        </div>
      </div>
      <!-- näytä valitun lehden/sarjan tietoja -->
      <div class="row" data-ng-show="justus.jufotunnus || justus.jufoluokitus">
        <div class="col-xs-12">
          <input type="hidden"
            data-ng-model="justus.jufotunnus">
          <input type="hidden"
            data-ng-model="justus.jufoluokitus">
          <!-- TODO show or not? -->
          <span data-ng-show="justus.jufotunnus">
            {{i18n.content.form.jufotunnus[lang]}}: {{justus.jufotunnus}}</span>
            <span data-ng-show="justus.jufotunnus && justus.jufoluokitus">,</span>
          <span data-ng-show="justus.jufoluokitus">
            {{i18n.content.form.jufoluokitus[lang]}}: {{getCode('julkaisufoorumitaso',justus.jufoluokitus).selite[lang]}}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: ISSN :: nb! issn vs isbn. required-ehto toimii vaikka isbn:ää ei lomakkeella olisikaan :: näkyy aina -->
  <div class="row form-group"
    id="issnGroup"
    data-ng-if="isFieldVisible('issn')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.issn[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.issn.tooltip[lang]}}"
        data-ng-show="i18n.content.form.issn.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('issn')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
            class="form-control"
            data-ng-model="justus.issn"
            placeholder="1234-567X">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('issn')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Volyymi :: näkyy aina -->
  <div class="row form-group"
    id="volyymiGroup"
    data-ng-if="isFieldVisible('volyymi')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.volyymi[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.volyymi.tooltip[lang]}}"
        data-ng-show="i18n.content.form.volyymi.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('volyymi')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
            class="form-control"
            data-ng-model="justus.volyymi"
            placeholder="{{ i18n.content.form.volyymi.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Numero :: näkyy aina -->
  <div class="row form-group" id="numeroGroup" data-ng-if="isFieldVisible('numero')">
    <div class="col-sm-4 col-xs-12 col-md-4">
      <label class="control-label" data-ng-bind="i18n.content.form.numero[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.numero.tooltip[lang]}}"
        data-ng-show="i18n.content.form.numero.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('numero')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
            class="form-control"
            data-ng-model="justus.numero"
            placeholder="{{ i18n.content.form.numero.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Sivut -->
  <div class="row form-group" id="sivutGroup" data-ng-if="isFieldVisible('sivut')">
    <div class="col-sm-4 col-xs-12 col-md-4">
      <label class="control-label" data-ng-bind="i18n.content.form.sivut[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.sivut.tooltip[lang]}}"
        data-ng-show="i18n.content.form.sivut.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('sivut')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
            class="form-control"
            data-ng-model="justus.sivut"
            placeholder="{{ i18n.content.form.sivut.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Artikkelinumero -->
  <div class="row form-group"
    data-ng-show="isFieldVisible('artikkelinumero')"
    id="artikkelinumeroGroup">
    <div class="col-sm-4 col-xs-12 col-md-4">
      <label class="control-label" data-ng-bind="i18n.content.form.artikkelinumero[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.artikkelinumero.tooltip[lang]}}"
        data-ng-show="i18n.content.form.artikkelinumero.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('artikkelinumero')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
            class="form-control"
            data-ng-model="justus.artikkelinumero"
            placeholder="{{ i18n.content.form.artikkelinumero.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Kustantaja -->
  <div class="row form-group" data-ng-if="isFieldVisible('kustantaja')" id="kustantajaGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.kustantaja[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.kustantaja.tooltip[lang]}}"
        data-ng-show="i18n.content.form.kustantaja.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('kustantaja')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
    data-ng-model="req_kustantaja" data-ng-required="requiredHighlight && !isValid('kustantaja')">
      <div class="row">
        <div class="col-xs-10">
          <input type="text" class="form-control"
            data-ng-model="justus.kustantaja"
            data-uib-typeahead="kustantajanimet.Name for kustantajanimet in refreshKanavanimet(2,$viewValue)"
            data-typeahead-loading="jufoKustantajaLataa"
            data-typeahead-no-results="jufoNoResults"
            data-typeahead-wait-ms="300"
            placeholder="{{i18n.content.form.kustantaja.picktip[lang]}}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class='fa fa-spinner fa-spin fa-lg' data-ng-show='jufoKustantajaLataa'></i>
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('kustantaja')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisun kustannuspaikka -->
  <div class="row form-group"
    data-ng-if="isFieldVisible('julkaisunkustannuspaikka')"
    id="julkaisunkustannuspaikkaGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.julkaisunkustannuspaikka[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisunkustannuspaikka.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisunkustannuspaikka.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisunkustannuspaikka')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-4">
          <input type="text"
          class="form-control"
          data-ng-model="justus.julkaisunkustannuspaikka"
          placeholder="{{ i18n.content.form.julkaisunkustannuspaikka.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-6">
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>


  <h3 class="form-header">{{i18n.content.tietojensyotto.muut[lang]}}</h3>

  <!-- loput kentät -->
  <!-- Kenttä: Avainsanat -->
  <div class="row form-group" id="avainsanatGroup" data-ng-if="isFieldVisible('avainsanat')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.avainsanat[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.avainsanat.tooltip[lang]}}"
        data-ng-show="i18n.content.form.avainsanat.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('avainsanat')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <tags-input data-ng-model="avainsanatTags"
        data-replace-spaces-with-dashes="false"
        data-add-on-comma="false"
        data-add-on-space="false"
        placeholder="{{i18n.content.form.avainsanat.picktip[lang]}}"
        data-on-tag-added="addAvainsana($tag)"
        data-on-tag-removed="removeAvainsana()"
        data-enable-editing-last-tag="true"
        display-property="prefLabel"
        key-property="localname"
        data-min-length="1">
        <auto-complete
          data-source="refreshAvainsanat($query)"
          data-load-on-down-arrow="true"
          data-min-length="1"
          data-debounce-delay="200"
          data-select-first-match="true">
        </auto-complete>
      </tags-input>
    </div>
  </div>

  <!-- Kenttä: Julkaisun kieli -->
  <div class="row form-group" id="julkaisunkieliGroup" data-ng-if="isFieldVisible('julkaisunkieli')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.julkaisunkieli[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisunkieli.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisunkieli.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisunkieli')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-model="sel_julkaisunkieli"
            data-ng-value="getCode('kieli',justus.julkaisunkieli.toUpperCase()).selite[lang]"
            data-uib-typeahead="o.selite[lang] for o in codes['kieli'] | filter: $viewValue"
            placeholder="{{i18n.content.form.julkaisunkieli.picktip[lang]}}"
            data-typeahead-on-select="useField('julkaisunkieli',$item.arvo.toLowerCase())"
            data-typeahead-editable="false">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisun kansainvälisyys -->
  <div class="row form-group"
    id="julkaisunkansainvalisyysGroup"
    data-ng-if="isFieldVisible('julkaisunkansainvalisyys')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.julkaisunkansainvalisyys[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisunkansainvalisyys.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisunkansainvalisyys.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisunkansainvalisyys')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_julkaisunkansainvalisyys">
      <div class="row">
        <div class="col-xs-10">
          <label data-ng-model="lab1_julkaisunkansainvalisyys"
            class="control-label">
            <input type="radio"
              data-ng-model="justus.julkaisunkansainvalisyys"
              value="1">
              {{i18n.content.form.julkaisunkansainvalisyys['1'][lang]}}
          </label>
          <label data-ng-model="lab2_julkaisunkansainvalisyys"
            class="control-label">
            <input type="radio"
              data-ng-model="justus.julkaisunkansainvalisyys"
              value="0">
              {{i18n.content.form.julkaisunkansainvalisyys['0'][lang]}}
          </label>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('julkaisunkansainvalisyys')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisumaa -->
  <div class="row form-group" data-ng-if="isFieldVisible('julkaisumaa')" id="julkaisumaaGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.julkaisumaa[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'" data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisumaa.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisumaa.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisumaa')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-value="getCode('maatjavaltiot2',justus.julkaisumaa).selite[lang]"
            data-ng-model="sel_julkaisumaa"
            data-uib-typeahead="o.arvo+' '+o.selite[lang] for o in codes['maatjavaltiot2'] | filter: $viewValue"
            data-typeahead-on-select="useField('julkaisumaa',$item.arvo)"
            placeholder="{{ i18n.content.form.julkaisumaa.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkistamispaikkakunta -->
  <div class="row form-group" data-ng-if="isFieldVisible('julkistamispaikkakunta')" id="julkistamispaikkakunta">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.julkistamispaikkakunta[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'" data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.julkistamispaikkakunta.tooltip[lang]}}"
         data-ng-show="i18n.content.form.julkistamispaikkakunta.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkistamispaikkakunta')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
         data-ng-model="julkistamispaikkakunta" data-ng-required="requiredHighlight && !isValid('julkistamispaikkakunta')">
      <div class="row">
        <div class="col-xs-10">
          <textarea type="text" class="form-control vertical-resize"
                    rows="1"
                    maxlength="1000"
                    placeholder="{{i18n.content.form.julkistamispaikkakunta.picktip[lang]}}"
                    data-ng-model="justus.tempLisatieto.julkistamispaikkakunta.lisatietoteksti">
          </textarea>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
             data-ng-if="requiredHighlight && !isValid('julkistamispaikkakunta')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Tapahtuman lisätieto -->
  <div class="row form-group" data-ng-if="isFieldVisible('tapahtumanlisatieto')" id="tapahtumalisatieto">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.tapahtumanlisatieto[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'" data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.tapahtumanlisatieto.tooltip[lang]}}"
         data-ng-show="i18n.content.form.tapahtumanlisatieto.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('lisatieto')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
         data-ng-model="req_tapahtuma" data-ng-required="requiredHighlight && !isValid('lisatieto')">
      <div class="row">
        <div class="col-xs-10">
          <textarea type="text" class="form-control vertical-resize"
                    rows="1"
                    maxlength="1000"
                    placeholder="{{i18n.content.form.tapahtumanlisatieto.picktip[lang]}}"
                    data-ng-model="justus.tempLisatieto.tapahtuma.lisatietoteksti">
          </textarea>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
             data-ng-if="requiredHighlight && !isValid('tapahtumanlisatieto')">
          </i>
        </div>
      </div>
    </div>
  </div>


  <!-- Kenttä: Julkaisun tieteenala -->
  <div class="row form-group"
    id="tieteenalaGroup"
    data-ng-if="isFieldVisible('tieteenala')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.tieteenala[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.tieteenala.tooltip[lang]}}"
        data-ng-show="i18n.content.form.tieteenala.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('tieteenala')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div data-ng-repeat="i in justus.tieteenala track by $index"
        class="row">
        <div class="col-xs-10">
          <div class="form-group">
            <input type="text"
                   ng-disabled="true"
                    class="form-control"
                    data-ng-model="lab_tieteenala$index"
                    data-ng-value="i.tieteenalakoodi+' '+getCode('tieteenalat',i.tieteenalakoodi).selite[lang]">
            <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
          </div>
        </div>
        <div class="col-xs-2">
          <button class="btn btn-primary m-b"
            data-ng-click="justus.tieteenala.splice($index, 1)"
            data-ng-if="justus.tieteenala.length >= 2 && (justus.tieteenala.length - 1) !== $index"
            title="{{i18n.content.form.tieteenala.poista.tooltip[lang]}}"
            data-ng-bind="i18n.content.form.tieteenala.poista.tooltip[lang]">
          </button>
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && (justus.tieteenala.length==0 || (justus.tieteenala.length>=1 && !justus.tieteenala[$index].tieteenalakoodi))">
          </i>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-5 col-xs-12 form-group">
          <ui-select data-ng-model="tieteenala.selected"
            on-select="useTieteenala($select.selected.arvo)"
            theme="bootstrap">
            <ui-select-match class="ui-select-match"
              placeholder="{{i18n.content.form.tieteenala.paa.picktip[lang]}}">
              {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
            </ui-select-match>
            <ui-select-choices repeat="o in codes.tieteenalat | orderBy: 'arvo' | filter: $select.search">
              {{o.arvo}} {{o.selite[lang]}}
            </ui-select-choices>
          </ui-select>
        </div>
        <div class="col-sm-5 col-xs-12 form-group"
          data-ALWAYS-ng-show="tieteenala_paa">
          <div data-ng-repeat="p in codes.tieteenalat"
            data-ng-if="p.arvo==tieteenala_paa">
            <ui-select data-ng-model="alatieteenalat.selected"
              on-select="useTieteenala($select.selected.arvo)"
              theme="bootstrap">
              <ui-select-match class="ui-select-match"
                placeholder="{{i18n.content.form.tieteenala.ala.picktip[lang]}}">
                {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
              </ui-select-match>
              <ui-select-choices repeat="o in alatieteenalat | orderBy: 'arvo' | filter: $select.search">
                {{o.arvo}} {{o.selite[lang]}}
              </ui-select-choices>
            </ui-select>
          </div>
          <!--dev--><!-- when paatieteenala not selected/used above --><!--enddev-->
          <!--dev--><!-- hack... now parent.index... --><!--enddev-->
          <div data-ng-if="!tieteenala_paa">
            <ui-select data-ng-model="alatieteenalat.selected"
              on-select="useTieteenala($select.selected.arvo)"
              theme="bootstrap">
              <ui-select-match class="ui-select-match"
                placeholder="{{i18n.content.form.tieteenala.ala.picktip[lang]}}">
                {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
              </ui-select-match>
              <ui-select-choices repeat="o in getAlltieteenalat() | orderBy: 'arvo'"
                ui-disable-choice="o.nogo">
                {{o.arvo}} {{o.selite[lang]}}
              </ui-select-choices>
            </ui-select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisun taiteenala -->
  <div class="row form-group"
       id="taiteenalaGroup"
       data-ng-if="isFieldVisible('taiteenala')">
      <div class="col-sm-4 col-xs-12">
        <label class="control-label"
               data-ng-bind="i18n.content.form.taiteenala[lang]"
        >
        </label>
           <i class="fa fa-info-circle justus-info"
              data-popover-trigger="'mouseenter'"
              data-popover-placement="right"
              data-uib-popover="{{i18n.content.form.taiteenala.tooltip[lang]}}"
              data-ng-show="i18n.content.form.taiteenala.tooltip[lang]">
          </i>
      <span data-ng-if="isFieldRequired('taiteenala')" class="required-star">*</span>
      </div>
      <div class="col-xs-10 col-sm-8 justus-data">
        <div data-ng-repeat="i in justus.taiteenala track by $index" class="row">
        <div class="col-xs-10">
          <div class="form-group">
            <input type="text" ng-disabled="true"
                   class="form-control"
                   data-ng-model="lab_taiteenala$index"
                   data-ng-value="i.taiteenalakoodi+' '+getCode('taiteenalat',i.taiteenalakoodi).selite[lang]">
            <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
          </div>
        </div>
        <div class="col-xs-2">
          <button class="btn btn-primary m-b"
                  data-ng-click="justus.taiteenala.splice($index, 1)"
                  data-ng-if="justus.taiteenala.length >= 2 && (justus.taiteenala.length - 1) !== $index"
                  title="{{i18n.content.form.taiteenala.poista.tooltip[lang]}}"
                  data-ng-bind="i18n.content.form.taiteenala.poista.tooltip[lang]">
          </button>
        </div>
      </div>
        <div class="row">
        <div class="col-xs-10 form-group">
              <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
                 <ui-select data-ng-model="taiteenala.selected"
                            on-select="useTaiteenala($select.selected.arvo)"
                            theme="bootstrap"
                 >
                    <ui-select-match class="ui-select-match"
                                     data-ng-value="justus.taiteenala"
                                     placeholder="{{i18n.content.form.taiteenala.picktip[lang]}}">
                      {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
                    </ui-select-match>
                    <ui-select-choices repeat="code in codes.taiteenalat | orderBy: 'arvo' | filter: $select.search">
                      {{code.arvo}} {{code.selite[lang]}}
                    </ui-select-choices>
                  </ui-select>
              </div>
            </div>
        </div>
  </div>

  <!-- Taiteenalan tyyppikategoria-->
  <div class="row form-group"
       id="taidealaTyyppiGroup"
       data-ng-if="isFieldVisible('taidealantyyppikategoria')">
    <div class="col-sm-4 col-xs-12">
       <label class="control-label"
              data-ng-bind="i18n.content.form.taidealantyyppikategoria[lang]"
       ></label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'"
         data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.taidealantyyppikategoria.tooltip[lang]}}"
         data-ng-show="i18n.content.form.taidealantyyppikategoria.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('taidealantyyppikategoria')" class="required-star">*</span>
    </div>
    <div class="col-xs-10 col-sm-8 justus-data">
    <div data-ng-repeat="i in justus.taidealantyyppikategoria" class="row">
      <div class="col-xs-10">
        <div class="form-group">
          <input type="text" ng-disabled="true"
          class="form-control"
          data-ng-model="lab_taidealantyyppikategoria$index"
          data-ng-value="i.tyyppikategoria+' '+getCode('taidealantyypit',i.tyyppikategoria).selite[lang]">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
      </div>
        <div class="col-xs-2">
          <button class="btn btn-primary m-b"
          data-ng-click="justus.taidealantyyppikategoria.splice($index, 1)"
          title="{{i18n.content.form.taidealantyyppikategoria.poista.tooltip[lang]}}"
          data-ng-bind="i18n.content.form.taidealantyyppikategoria.poista.tooltip[lang]">
          </button>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-10 form-group">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
          <ui-select data-ng-model="taidealantyyppikategoria.selected"
                     on-select="useTaidelanTyyppi($select.selected.arvo)"
                     theme="bootstrap"
          >
          <ui-select-match class="ui-select-match"
                           data-ng-value="justus.taidealantyyppikategoria"
                           placeholder="{{i18n.content.form.taidealantyyppikategoria.picktip[lang]}}">
          {{ $select.selected.arvo }} {{ $select.selected.selite[lang] }}
          </ui-select-match>
          <ui-select-choices repeat="code in codes.taidealantyypit | orderBy: 'arvo' | filter: $select.search">
          {{code.arvo}} {{code.selite[lang]}}
          </ui-select-choices>
          </ui-select>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Kansainvälinen yhteisjulkaisu -->
  <div class="row form-group"
    id="kansainvalinenyhteisjulkaisuGroup"
    data-ng-if="isFieldVisible('kansainvalinenyhteisjulkaisu')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.kansainvalinenyhteisjulkaisu[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.kansainvalinenyhteisjulkaisu.tooltip[lang]}}"
        data-ng-show="i18n.content.form.kansainvalinenyhteisjulkaisu.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('kansainvalinenyhteisjulkaisu')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_kansainvalinenyhteisjulkaisu"
      data-ng-required="requiredHighlight && !isValid('kansainvalinenyhteisjulkaisu')">
      <div class="row">
        <div class="col-xs-10">
          <label data-ng-model="lab1_kansainvalinenyhteisjulkaisu" class="control-label">
            <input type="radio"
              data-ng-model="justus.kansainvalinenyhteisjulkaisu"
              value="1">
              {{i18n.content.form.kansainvalinenyhteisjulkaisu['1'][lang]}}
          </label>
          <label data-ng-model="lab2_kansainvalinenyhteisjulkaisu"
            class="control-label">
            <input type="radio"
              data-ng-model="justus.kansainvalinenyhteisjulkaisu"
              value="0">
              {{i18n.content.form.kansainvalinenyhteisjulkaisu['0'][lang]}}
          </label>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('kansainvalinenyhteisjulkaisu')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Yhteisjulkaisu yrityksen kanssa -->
  <div class="row form-group"
    id="yhteisjulkaisuyrityksenkanssaGroup"
    data-ng-if="isFieldVisible('yhteisjulkaisuyrityksenkanssa')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.yhteisjulkaisuyrityksenkanssa[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.yhteisjulkaisuyrityksenkanssa.tooltip[lang]}}"
        data-ng-show="i18n.content.form.yhteisjulkaisuyrityksenkanssa.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('yhteisjulkaisuyrityksenkanssa')"
        class="required-star">*
      </span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_yhteisjulkaisuyrityksenkanssa"
      data-ng-required="requiredHighlight && !isValid('yhteisjulkaisuyrityksenkanssa')">
      <div class="row">
        <div class="col-xs-10">
          <label data-ng-model="lab1_yhteisjulkaisuyrityksenkanssa" class="control-label">
            <input type="radio"
              data-ng-model="justus.yhteisjulkaisuyrityksenkanssa"
              value="1">
            {{i18n.content.form.yhteisjulkaisuyrityksenkanssa['1'][lang]}}
          </label>
          <label data-ng-model="lab2_yhteisjulkaisuyrityksenkanssa" class="control-label">
            <input type="radio"
              data-ng-model="justus.yhteisjulkaisuyrityksenkanssa"
              value="0">
              {{i18n.content.form.yhteisjulkaisuyrityksenkanssa['0'][lang]}}
          </label>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('yhteisjulkaisuyrityksenkanssa')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: DOI-tunniste -->
  <div class="row form-group"
    id="doitunnisteGroup"
    data-ng-if="isFieldVisible('doitunniste')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.doitunniste[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.doitunniste.tooltip[lang]}}"
        data-ng-show="i18n.content.form.doitunniste.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('doitunniste')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-model="justus.doitunniste"
            placeholder="{{ i18n.content.form.doitunniste.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Muu tunniste lisätieto -->
  <div class="row form-group" data-ng-if="isFieldVisible('muutunniste')" id="muutunniste">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.muutunniste[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'" data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.muutunniste.tooltip[lang]}}"
         data-ng-show="i18n.content.form.muutunniste.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('muutunniste')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
         data-ng-model="req_muutunniste" data-ng-required="requiredHighlight && !isValid('muutunniste')">
      <div class="row">
        <div class="col-xs-10">
          <textarea type="text" class="form-control vertical-resize"
                    rows="1"
                    maxlength="1000"
                    placeholder="{{i18n.content.form.muutunniste.picktip[lang]}}"
                    data-ng-model="justus.tempLisatieto.muutunniste.lisatietoteksti">
          </textarea>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
             data-ng-if="requiredHighlight && !isValid('muutunniste')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Pysyvä verkko-osoite -->
  <div class="row form-group"
    id="pysyvaverkkoosoiteGroup"
    data-ng-if="isFieldVisible('pysyvaverkkoosoite')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.pysyvaverkkoosoite[lang]"></label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.pysyvaverkkoosoite.tooltip[lang]}}"
        data-ng-show="i18n.content.form.pysyvaverkkoosoite.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('pysyvaverkkoosoite')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-model="justus.pysyvaverkkoosoite"
            placeholder="{{ i18n.content.form.pysyvaverkkoosoite.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Avoin saatavuus -->
  <div class="row form-group"
    id="avoinsaatavuusGroup"
    data-ng-if="isFieldVisible('avoinsaatavuus')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.avoinsaatavuus[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.avoinsaatavuus.tooltip[lang]}}"
        data-ng-show="i18n.content.form.avoinsaatavuus.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('avoinsaatavuus')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_avoinsaatavuus"
      data-ng-required="requiredHighlight && !isValid('avoinsaatavuus')">
      <div class="row">
        <div class="col-xs-10">
          <label data-ng-model="lab1_avoinsaatavuus" class="control-label">
            <input type="radio"
              data-ng-model="justus.avoinsaatavuus"
              value="0">
              {{i18n.content.form.avoinsaatavuus['0'][lang]}}
          </label>
          <br>
          <label data-ng-model="lab2_avoinsaatavuus" class="control-label">
            <input type="radio"
              data-ng-model="justus.avoinsaatavuus"
              value="1">
              {{i18n.content.form.avoinsaatavuus['1'][lang]}}
              <i class="fa fa-info-circle justus-info"
                data-popover-trigger="'mouseenter'"
                data-popover-placement="right"
                data-uib-popover="{{i18n.content.form.avoinsaatavuus['1'].tooltip[lang]}}"
                data-ng-show="i18n.content.form.avoinsaatavuus['1'].tooltip[lang]">
              </i>
          </label>
          <br>
          <label data-ng-model="lab3_avoinsaatavuus" class="control-label">
            <input type="radio"
              data-ng-model="justus.avoinsaatavuus"
              value="2">
            {{i18n.content.form.avoinsaatavuus['2'][lang]}}
            <i class="fa fa-info-circle justus-info"
              data-popover-trigger="'mouseenter'"
              data-popover-placement="right"
              data-uib-popover="{{i18n.content.form.avoinsaatavuus['2'].tooltip[lang]}}"
              data-ng-show="i18n.content.form.avoinsaatavuus['2'].tooltip[lang]">
            </i>
          </label>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('avoinsaatavuus')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Julkaisu rinnakkaistallennettu -->
  <div class="row form-group"
    id="julkaisurinnakkaistallennettuGroup"
    data-ng-if="isFieldVisible('julkaisurinnakkaistallennettu')">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.julkaisurinnakkaistallennettu[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.julkaisurinnakkaistallennettu.tooltip[lang]}}"
        data-ng-show="i18n.content.form.julkaisurinnakkaistallennettu.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('julkaisurinnakkaistallennettu')"
        class="required-star">*
      </span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-required="requiredHighlight && !isValid('julkaisurinnakkaistallennettu')">
      <div class="row">
        <div class="col-xs-10">
          <label class="control-label">
            <input type="radio"
              data-ng-model="justus.julkaisurinnakkaistallennettu"
              value="1">
              {{i18n.content.form.julkaisurinnakkaistallennettu['1'][lang]}}
          </label>
          <label class="control-label">
            <input type="radio"
              data-ng-model="justus.julkaisurinnakkaistallennettu"
              value="0">
              {{i18n.content.form.julkaisurinnakkaistallennettu['0'][lang]}}
          </label>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('julkaisurinnakkaistallennettu')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Rinnakkaistallennetun version verkko-osoite -->
  <div class="row form-group"
    data-ng-if="isFieldVisible('rinnakkaistallennetunversionverkkoosoite') && justus.julkaisurinnakkaistallennettu === '1'"
    id="rinnakkaistallennetunversionverkkoosoiteGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label"
        data-ng-bind="i18n.content.form.rinnakkaistallennetunversionverkkoosoite[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
        data-popover-trigger="'mouseenter'"
        data-popover-placement="right"
        data-uib-popover="{{i18n.content.form.rinnakkaistallennetunversionverkkoosoite.tooltip[lang]}}"
        data-ng-show="i18n.content.form.rinnakkaistallennetunversionverkkoosoite.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('rinnakkaistallennetunversionverkkoosoite')"
        class="required-star">*
      </span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
      data-ng-model="req_rinnakkaistallennetunversionverkkoosoite"
      data-ng-required="requiredHighlight && !isValid('rinnakkaistallennetunversionverkkoosoite')">
      <div class="row">
        <div class="col-xs-10">
          <input type="text"
            class="form-control"
            data-ng-model="justus.rinnakkaistallennetunversionverkkoosoite"
            placeholder="{{ i18n.content.form.rinnakkaistallennetunversionverkkoosoite.picktip[lang] }}">
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
            data-ng-if="requiredHighlight && !isValid('rinnakkaistallennetunversionverkkoosoite')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <!-- Kenttä: Lisätieto -->
  <div class="row form-group" data-ng-if="isFieldVisible('lisatieto')" id="lisatietoGroup">
    <div class="col-sm-4 col-xs-12">
      <label class="control-label" data-ng-bind="i18n.content.form.lisatieto[lang]">
      </label>
      <i class="fa fa-info-circle justus-info"
         data-popover-trigger="'mouseenter'" data-popover-placement="right"
         data-uib-popover="{{i18n.content.form.lisatieto.tooltip[lang]}}"
         data-ng-show="i18n.content.form.lisatieto.tooltip[lang]">
      </i>
      <span data-ng-if="isFieldRequired('lisatieto')" class="required-star">*</span>
    </div>
    <div class="col-sm-8 col-xs-12 justus-data"
         data-ng-model="req_lisatieto" data-ng-required="requiredHighlight && !isValid('lisatieto')">
      <div class="row">
        <div class="col-xs-10">
          <textarea type="text" class="form-control vertical-resize"
                 maxlength="1000"
                 data-ng-model="justus.lisatieto"
                 placeholder="{{i18n.content.form.lisatieto.picktip[lang]}}">
          </textarea>
          <span class="fa fa-times form-control-feedback" aria-hidden="true"></span>
        </div>
        <div class="col-xs-2">
          <i class="fa fa-arrow-left pull-right form-control-feedback-extra"
             data-ng-if="requiredHighlight && !isValid('lisatieto')">
          </i>
        </div>
      </div>
    </div>
  </div>

  <div class="row" data-ng-if="invalidFields.length > 0">
    <div class="col-xs-12">
      <div class="alert alert-danger">
        <h3 data-ng-click="useRequiredHighlight()">
        {{i18n.content.tietojensyotto.taytaviela[lang]}}
        </h3>
        <div>
          <span data-ng-repeat="o in invalidFields">
            <i data-ng-bind="i18n.content.form[o][lang]?i18n.content.form[o][lang]:o"></i>
            <br>
          </span>
        </div>
      </div>
    </div>
  </div>
</span>

<!-- JATKA -->
<div class="row form-group">
  <!-- <div class="row"> -->
  <div class="col-md-8">
    <button class="btn btn-lg btn-block btn-primary"
      type="button"
      data-ng-click="useVaihe(4)">
      {{i18n.content.tietojensyotto.jatka[lang]}}
    </button>
  </div>
  <div class="col-md-4">
    <button class="btn btn-lg btn-block btn-danger"
            type="button"
            data-ng-click="cancelAndGoToPublicationListing()">
      {{i18n.content.tietojensyotto.keskeyta[lang]}}
    </button>
  </div>
  <!-- </div> -->
</div>
